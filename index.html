<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Launcher → about:blank Web Viewer</title>
  <style>
    :root{--bg:#0b1220;--card:#111a2e;--text:#e5eef7;--muted:#9fb3c8;--accent:#6ee7ff;--accent2:#a78bfa}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:radial-gradient(1200px 800px at 10% 10%,#0f1a30 0%,var(--bg) 60%),radial-gradient(1000px 700px at 90% 90%,#0d1530 0%,var(--bg) 60%);color:var(--text);display:grid;place-items:center;padding:24px}
    .card{width:min(900px,94vw);background:linear-gradient(180deg,var(--card),#0f1a28);border:1px solid #20304d;border-radius:18px;padding:36px;box-shadow:0 10px 30px #0006,inset 0 1px 0 #fff2;text-align:center}
    h1{margin:0 0 8px;letter-spacing:.2px}
    p{margin:0 0 18px;color:var(--muted)}
    .launch{appearance:none;border:0;padding:28px 32px;border-radius:16px;font-size:22px;font-weight:800;letter-spacing:.3px;cursor:pointer;background:linear-gradient(180deg,var(--accent),var(--accent2));color:#0a101d;text-shadow:0 1px 0 #ffffffbf;box-shadow:0 12px 30px #0008,inset 0 1px 0 #ffffff2;width:100%;max-width:560px;transition:transform .05s ease,box-shadow .2s ease}
    .launch:hover{box-shadow:0 14px 34px #000c}
    .launch:active{transform:translateY(2px)}
    .status{margin-top:12px;color:var(--muted);font-size:14px}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
  </style>
</head>
<body>
  <main class="card">
    <h1>Launch in <code>about:blank</code></h1>
    <p>Opens a scriptable blank tab and injects a simple in-page <strong>Web Viewer</strong> (paste any URL). Sites may block embedding.</p>
    <button id="openBlank" class="launch" type="button">Launch Web Viewer</button>
    <div id="status" class="status" aria-live="polite"></div>
  </main>

  <script>
    const status = document.getElementById('status');

    function appHtml(){ return `<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>about:blank • Web Viewer</title>
<style>
  :root{--bg:#0b1220;--chrome:#0f172a;--muted:#a0b4cc;--fg:#e5eef7;--btn:#1b2540;--accent:#38bdf8}
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;display:flex;flex-direction:column}
  .topbar{display:flex;gap:8px;align-items:center;padding:10px;background:var(--chrome);border-bottom:1px solid #1e2b4a;flex-wrap:wrap}
  .btn{border:0;border-radius:10px;padding:10px 14px;background:var(--btn);color:#cfe6ff;cursor:pointer;font-weight:700}
  .btn:active{transform:translateY(1px)}
  .addr{flex:1;display:flex;gap:8px;min-width:260px}
  .addr input{flex:1;padding:10px 12px;border-radius:10px;border:1px solid #243353;background:#0e1728;color:#e5eef7;font-size:14px}
  .stage{position:relative;flex:1}
  .frameWrap{position:absolute;inset:0}
  #webview{position:absolute;inset:0;width:100%;height:100%;border:0;background:#000}
  .overlay{position:absolute;top:12px;left:12px;right:12px;padding:10px 12px;border-radius:10px;background:#0f172acc;color:#e5eef7;border:1px solid #22345a;backdrop-filter:blur(4px);font-size:13px;display:none}
</style>
</head>
<body>
  <div class="topbar">
    <button id="home" class="btn" title="Home">Home</button>
    <div class="addr">
      <input id="addrInput" placeholder="Paste a URL (e.g., https://example.org)" />
      <button id="go" class="btn" style="background:var(--accent);color:#081320">Go</button>
      <button id="goNewTab" class="btn" title="Open in new tab">↗︎</button>
      <button id="fs" class="btn" title="Fullscreen">⛶</button>
    </div>
  </div>
  <div class="stage">
    <div id="webwrap" class="frameWrap">
      <iframe id="webview" sandbox="allow-scripts allow-forms allow-same-origin allow-popups allow-presentation"></iframe>
      <div id="webOverlay" class="overlay">Loading… If this stays blank, the site likely blocks embedding with <code>X-Frame-Options</code> or <code>Content-Security-Policy</code>. Use ↗︎ to open in a new tab.</div>
    </div>
  </div>

  <script>
    function normalizeUrl(raw){
      let u = (raw||'').trim();
      if(!u) return '';
      if(/^https?:\/\//i.test(u)) return u;
      if(/^[\w.-]+\.[a-z]{2,}(?:\/.*)?$/i.test(u)) return 'https://' + u;
      return 'https://www.google.com/search?q=' + encodeURIComponent(u);
    }
    function loadUrlInFrame(raw){
      const frame = document.getElementById('webview');
      const overlay = document.getElementById('webOverlay');
      const url = normalizeUrl(raw);
      if(!url){ overlay.textContent = 'Enter a URL to open.'; overlay.style.display='block'; return; }
      overlay.textContent = 'Loading… If this stays blank, the site likely blocks embedding with X-Frame-Options or Content-Security-Policy. Use ↗︎ to open in a new tab.';
      overlay.style.display='block';
      frame.src = url;
      let done=false;
      frame.onload = () => { done=true; overlay.style.display='none'; };
      setTimeout(()=>{ if(!done) overlay.style.display='block'; }, 1500);
    }

    document.addEventListener('DOMContentLoaded',()=>{
      const addr=document.getElementById('addrInput');
      const go=document.getElementById('go');
      const goNew=document.getElementById('goNewTab');
      const fs=document.getElementById('fs');
      const home=document.getElementById('home');

      go.addEventListener('click',()=> loadUrlInFrame(addr.value));
      addr.addEventListener('keydown',(e)=>{ if(e.key==='Enter') go.click(); });
      goNew.addEventListener('click',()=>{ const u = normalizeUrl(addr.value); if(u) window.open(u,'_blank'); });
      fs.addEventListener('click',()=>{ const el=document.getElementById('webview'); if(el.requestFullscreen) el.requestFullscreen(); });
      home.addEventListener('click',()=>{ addr.value='https://example.org'; loadUrlInFrame(addr.value); });

      // Default home
      addr.value='https://example.org';
      loadUrlInFrame(addr.value);
    });
  <\/script>
</body>
</html>`; }

    document.getElementById('openBlank').addEventListener('click',()=>{
      try{
        const w = window.open('about:blank','_blank');
        if(!w){ status.textContent='Popup was blocked. Allow pop‑ups and try again.'; return; }
        const html = appHtml();
        w.document.open();
        w.document.write(html);
        w.document.close();
      }catch(err){ status.textContent='Could not open about:blank due to a browser restriction.'; }
    });
  </script>
</body>
</html>
